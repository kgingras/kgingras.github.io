<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Daniel Wilson</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" 
      type="image/png" 
      href="Images/Logo.ico">
    <link href="Styles/style.css" rel="stylesheet" />
    <link href="Styles/terminal.css" rel="stylesheet" />
    <link href='http://fonts.googleapis.com/css?family=Pacifico|Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

</head>
<body>
	<div id="links">
		<a class="link" href="blog">blog</a>
		<a class="link" href="mailto:wilsoda@umich.edu">contact</a>
		<a class="link" href="res/resume.pdf" download="danielwilson.pdf">resume</a>
		<a class="link" href="project">projects</a>
	</div>
	<div id="title">
		Daniel Wilson
	</div>
<!-- 	<div id="subtitle">
		MAKE A DIFFERENCE
	</div> -->
	<!-- <div id="laptop"></div> -->
    <div id="lapOut">
        <div id="lapIn">
                    <div id="lapScreen">
                    </div>
        </div>
    </div>
    <div id="lapBottom">
        <div id="thing">
        </div>
    </div>
    <div id="lapUnder">
    </div>
<form method="POST" action="http://formspree.io/wilsoda@umich.edu" id="f">
  <input type="email" name="_replyto"></input>
  <textarea name="body"></textarea>
  <input type="submit" value="Send"></input>
</form>
</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="terminal.js"></script>
<script>

function validateEmail(x) {
    var atpos = x.indexOf("@");
    var dotpos = x.lastIndexOf(".");
    if (atpos< 1 || dotpos<atpos+2 || dotpos+2>=x.length) {
        return false;
    }
    return true;
}

$(function() {
                        $("#f").on("submit", function(e) {
                        e.preventDefault();
                        $.ajax({
                        url: $(this).attr("action"),
                        type: 'POST',
                        data: $(this).serialize(),
                        beforeSend: function() {
                            alert('sending...');
                        },
                        success: function(data) {
                            alert('sent');
                        },
                        error: function() {
                            alert('err');
                        }
                    });
                });
            });

jQuery(function($, undefined) {
    $('#lapScreen').terminal(function(command, term) {

        var form = $('#f');
        form.method = "POST";
        form.action = "http://formspree.io/wilsoda@umich.edu";

        if (command !== '') {
            if(command == 'help') {
                term.echo("available commands are:\nprojects resume contact");
            } 
            else if( command == 'contact' ) {
                term.push(function(command) {
            if (!validateEmail(command)) {
                term.echo('bad email');
                term.pop();
            } //good email 
            else {
                term.pop();
                form._replyto = command;
                term.push(function(name) {
                    term.pop();
                    form.name = name;
                    term.push(function(msg) {
                        term.pop();
                        form.body = msg;
                        console.log(form.body);
                        console.log(form.name);
                        console.log(form._replyto);
                        //Send the Email
                        form.submit();

                    }, {prompt:'Message: '});
                },{prompt:'Name: '});
            }
            }, {
                prompt: 'Email: '
            });
            } else if(command == 'resume') {

            } else if(command == 'projects') {

            } else {
                try {
                    var result = window.eval(command);
                    if (result !== undefined) {
                        term.echo(new String(result));
                    }
                } catch(e) {
                    term.error(new String(e));
                    term.error("Try help");
                }
            }
        } else {
           term.echo('');
        }
    }, {
        greetings: '',
        name: 'js_demo',
        prompt: '> '});
});
</script>
